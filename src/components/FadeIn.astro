---
// src/components/FadeIn.astro

// Komponens tulajdonságai
const { delay = '0ms', duration = '700ms' } = Astro.props; 

// Az animáció stílusa és kezdeti állapota:
// opacity: 0 (láthatatlan) és translateY(30px) (enyhén eltolva alulról)
const startStyle = `opacity: 0; transform: translateY(30px); transition: opacity ${duration} ease-out, transform ${duration} ease-out; transition-delay: ${delay};`;
---

<div 
    class="fade-in-container" 
    style={startStyle}
>
    <slot />
</div>

<script>
    // Intersection Observer logikája, ami a kliens oldalon fut
    
    // Az observer-t csak egyszer definiáljuk
    const observer = new IntersectionObserver((entries, observer) => {
        entries.forEach(entry => {
            // Ha az elem láthatóvá válik
            if (entry.isIntersecting) {
                const target = entry.target as HTMLElement;

                // Animált stílus hozzáadása: láthatóvá tétel és pozíció visszaállítása
                target.style.opacity = '1';
                target.style.transform = 'translateY(0)';
                
                // Leállítjuk a figyelést, mivel beúszott
                observer.unobserve(target);
            }
        });
    }, {
        // -100px-es margó: az animáció akkor indul, amikor az elem 100px-re van a képernyő aljától
        rootMargin: '0px 0px -100px 0px', 
        threshold: 0.01 
    });

    // Minden FadeIn konténer figyelése
    document.querySelectorAll('.fade-in-container').forEach(element => {
        observer.observe(element);
    });
</script>